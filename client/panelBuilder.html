<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
        <meta http-equiv="Pragma" content="no-cache">
        <meta http-equiv="Expires" content="Thu, 01 Jan 1970 00:00:00 GMT">
        <title>Layout builder</title>

        <script type="text/javascript" src="libraries/jquery-3.7.1.min.js"></script>
        <script type="text/javascript" src="libraries/konva.min.js"></script>
        <script type="text/javascript" src="libraries/underscore.js"></script>
        <script type="text/javascript" src="libraries/jquery-ui.js"></script>
        <script type="text/javascript" src="libraries/jsv.js"></script>
        <script type="text/javascript" src="libraries/jsonform.js"></script>

        <link rel="stylesheet" href="style/ext/water.css">
        <link rel="stylesheet" href="style/ext/all.min.css" crossorigin="anonymous" />

        <link rel="stylesheet" href="style/main.css">
        <link rel="stylesheet" href="style/buttons.css">
        <link rel="stylesheet" href="style/panelBuilder.css">
    </head>
<body>
    <nav id="topNav" class="topNav">
        <button id="showControllers" onclick="showControllers()">Show controllers</button>
        <button id="hideControllers" onclick="hideControllers()" style="display: none;" >Hide controllers</button>
        <button id="showConnectors" onclick="showConnectors()" >Show connectors</button>
        <button id="hideConnectors" onclick="hideConnectors()" style="display: none;" >Hide connectors</button>
    </nav>

    <section class="content">
        <div id="trackCanvas" style="width:1024px; height:600px; display: inline-block; position: relative;">
        </div>
    </section>

    <div id="buttonsContainer" class="buttons-container">
        <div class="title-bar">
            <span class="panel-title">Panel Editor</span>
            <button class="toggle-btn">-</button>
        </div>
        <div class="buttons-content" style="display: block;">
            <div style="column-count: 2;">
                <button id="addPoint" onclick="addPoint('normal')">Add Point</button>
                <button id="addPointToStraight" onclick="addPoint('toStraight')">Add Point (to straight)</button>
                <button id="addPointToSiding" onclick="addPoint('toSiding')">Add Point (to siding)</button>
                <button id="addCrossover" onclick="addPoint('crossOver')">Add Crossover</button>
                <button id="addStraightShort" onclick="addStraight('short')">Add Straight (short)</button>
                <button id="addStraightLong" onclick="addStraight('long')">Add Straight (long)</button>
                <button id="addDiagonal" onclick="addDiagonal()">Add Diagonal</button>
                <button id="addCurveConnection" onclick="addCurve(1)">Add Curve (Radius 1)</button>
                <button id="addSignal" onclick="addSignal('red')">Add Signal</button>
                <button id="addControlElement" onclick="addControlElement()">Add Control Panel</button>
            </div>
            <div style="column-count: 1;">
                <button id="savePanel" onclick="saveStage()">Save panel</button>
            </div>
        </div>
    </div>

    <template id="popupTemplate">
        <div class="popup-overlay" style="position: absolute; top: 20px; left: 20px; width: calc(100% - 40px); height: calc(100% - 40px); background-color: rgba(0, 0, 0, 0.9); z-index: 9999; max-height: calc(100% - 40px); overflow-y: scroll;">
            <button id="closeButton" style="position: absolute; top: 10px; right: 10px; z-index: 1000;">X</button>
            <div class="popup-content" style="position: absolute; padding: 20px; border-radius: 5px; width: inherit;">
                <div id="res" class="alert"></div>
                <h2>Configure <span id="elementType"></span></h2>
                <form id="configureElementForm" method="">
                </form>
            </div>
        </div>
    </template>

    <footer id="footer" class="footer">
        <div id="log" class="log"></div>
        <div class="serverStatus">
            Status: <span id="serverStatus"></span>
        </div>
    </footer>

    <script src="js/panelBuilder.js"></script>
    <script src="js/panelBuilderServer.js"></script>
    <style>
    fieldset .form-group {
        display: inline-block;
        margin-right: 1em;
    }
    .jsonform-error-Aspects {
        margin-bottom: 4em;
    }
    #configureElementForm ul {
        margin: 0em;
    }
    #configureElementForm ul li {
        margin-top: -0.8em;
        margin-bottom: -3.6em;
    }
    #configureElementForm ul li ._jsonform-array-buttons {
        position: relative;
        top: -66px;
        left: -40px;
    }
    #configureElementForm ._jsonform-array-buttons {
        position: relative ;
        top: 2em;
        left: 0m;
    }
    </style>
</body>
</html>